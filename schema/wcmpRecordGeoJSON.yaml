$schema: 'https://json-schema.org/draft/2020-12/schema'
$id: 'https://raw.githubusercontent.com/wmo-im/wcmp2/main/schema/wcmpRecordGeoJSON.yaml'
title: WCMP 2 discovery metadata record definition
description: WCMP 2 discovery metadata record definition

# Extension of https://raw.githubusercontent.com/opengeospatial/ogcapi-records/master/core/openapi/schemas/recordGeoJSON.yaml
required:
  - id
  - type
  - time
  - geometry
  - properties
  - links
properties:
  id:
    type: string
    description:
      A unique identifier of the catalogue record.
    format: uri
  conformsTo:
    $ref: ogcapi/records/part1/1.0/confClasses.yaml#/properties/conformsTo
  type:
    type: string
    enum:
      - Feature
  time:
    oneOf:
      - type: null
      - type: object
        properties:
          oneOf:
            - type: string
              format: date-time
            - type: array
              minItems: 2
              maxItems: 2
              items:
                oneOf:
                  - type: null
                  - type: string
                    format: date-time
  geometry:
    oneOf:
      - type: null
      - $ref: ogcapi/records/part1/1.0/geometryGeoJSON.yaml
  additionalExtents:
    $ref: 'https://raw.githubusercontent.com/opengeospatial/ogcapi-environmental-data-retrieval/master/standard/openapi/schemas/collections/extent.yaml'
  properties:
    type: object
    required:
      - type
      - title
      - description
      - themes
      - providers
      - recordCreated
      - wmo:dataPolicy
    properties:
      externalIds:
        type: array
        description:
          An identifier for the resource assigned by an external (to the
          catalogue) entity.
        items:
          type: object
          properties:
            scheme:
              type: string
              description:
                A reference to an authority or identifier for a knowledge
                organization system from which the external identifier was
                obtained.  It is recommended that the identifier be a
                resolvable URI.
              value:
                type: string
                description: The value of the identifier.
          required:
            - value
  additionalExtents:
      type:
        type: string
        description:
          The nature or genre of the resource. The value should be a code,
          convenient for filtering the records. Where available, a link to
          the canonical URI of the record type resource will be added to
          the 'links' property.
        maxLength: 64
      title:
        type: string
        description:
          A human-readable name given to the resource.
      description:
        type: string
        description:
          A free-text account of the resource.
      keywords:
        type: array
        description:
          The topic or topics of the resource. Typically represented using
          free-form keywords, tags, key phrases, or classification codes.
        items:
          type: string
      themes:
        type: array
        description:
          A knowledge organization system used to classify the resource.
        items:
          type: object
          properties:
            concepts:
              type: array
              description:
                One or more entity/concept identifers from this knowledge
                system. it is recommended that a resolvable URI be used
                for each entity/concept identifier.
              items:
                type: object
                properties:
                  id:
                    type: string
                    description: An identifier for the concept.
                  title:
                    type: string
                    description: A human readable title for the concept.
                  description:
                    type: string
                    description: A human readable description for the concept.
                  url:
                    type: string
                    format: uri
                    description: A URI providing further description of the concept.
                required
                  - id
            scheme:
              type: string
              description:
                An identifier for the knowledge organization system used
                to classify the resource.  It is recommended that the
                identifier be a resolvable URI.
      providers:
        type: array
        items:
          $ref: ogcapi/records/part1/1.0/party.yaml
        description:
          A list of providers qualified by their role in association to the
          record.
      version:
        type: string
        description: The version or edition of a given dataset.
      created:
        type: string
        description:
          Date of creation of this record.
        format: date-time
      updated:
        type: string
        description:
          The most recent date on which the record was changed.
        format: date-time
      wmo:dataPolicy:
        type: object
        description: The data policy definition as per the WMO Unified Data Policy Resolution (Res.1) [23].
        properties:
          name:
            type: string
            description: The WMO Unified Data Policy identifier (`core` or `recommended`).
            enum:
              - core
              - recommended
          additionalConditions:
            type: array
            items:
              type: object
              description: Additional conditions applied to recommended data
              properties:
                name:
                  type: string
                  description: Name of additional condition, from a codelist, or the string value `none` if there are no additional conditions on a recommended dataset.
                scheme:
                  type: string
                  description: codelist or controlled vocabulary to which the condition applies to.
                link:
                  $ref: link.yaml
              required:
                - name
            minItems: 1
        required:
          - name
  links:
    items:
      $ref: link.yaml
